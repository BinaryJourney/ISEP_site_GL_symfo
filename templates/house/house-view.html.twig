{% extends "base.html.twig" %}

{% block body %}

    <div class="w-100 d-flex flex-column bg-white" style="min-height: 100vh">

        {% if houses %}
            <div class="card-body" style="flex: 0">
                <h5 class="card-title text-center text-uppercase">Liste des logements</h5>
            </div>
        {% else %}
            <div class="card-body" style="flex: 0">
                <h5 class="card-title text-center text-uppercase">Aucun logement disponible</h5>
            </div>
        {% endif %}


        {{ form_start(form) }}
        <div class="d-flex ms-3" style="flex-direction: row">
            <div class="form-group">
                {{ form_label(form.key_type_accommodation_capacity, 'Recherche par capacité necessaire') }}
                {{ form_widget(form.key_type_accommodation_capacity) }}
                {{ form_help(form.key_type_accommodation_capacity) }}
            </div>
            <div class="form-group mt-auto ms-3 h-50">
                {{ form_widget(form.Rechercher) }}
            </div>
        </div>
        {{ form_end(form) }}



        {% for house in houses %}

            <div class="list-group mt-4">
                <div class="row">
                    <div class="col-lg-10 mx-auto">
                        <!-- List group-->
                        <ul class="list-group shadow mt-2">
                            <!-- list group item-->
                            <li class="list-group-item">
                                <!-- Custom content-->
                                <div class="media align-items-lg-center flex-column flex-lg-row p-3">
                                    <div class="media-body order-2 order-lg-1">
                                        <a href="{{ path('app_house_detailed_view', {'id': house.id}) }}" style="text-decoration: none">
                                            <h4 class="mt-0 font-weight-bold mb-4" style="color: black;">{{ house.title }}</h4>
                                        </a>
                                        <p class="font-italic text-muted my-0 small text-truncate">
                                            {{ house.description }}
                                        </p>

                                        <div class="d-flex align-items-center mt-4">
                                            <i class="bi bi-stars"></i>
                                            <p>&nbsp;</p>
                                            <p class="font-weight-bold my-0">Ville : </p>
                                        </div>
                                        <div class="container">
                                            <p class="font-italic my-0 small text-truncate">
                                                {{ house.keyListeVilleFrance.name ~ ' (' ~ house.keyListeVilleFrance.department ~ ')' }}
                                            </p>
                                        </div>

                                        <div class="d-flex align-items-center mt-4">
                                            <i class="bi bi-stars"></i>
                                            <p>&nbsp;</p>
                                            <p class="font-weight-bold my-0">Capacité : </p>
                                        </div>
                                        <div class="container">
                                            <p class="font-italic my-0 small text-truncate">
                                                {{ house.keyTypeAccommodationCapacity.capacity }}
                                            </p>
                                        </div>

                                        <div class="d-flex align-items-center mt-4">
                                            <i class="bi bi-calendar-week-fill"></i>
                                            <p>&nbsp;</p>
                                            <p class="font-weight-bold my-0">Dates de disponibilité : </p>
                                        </div>
                                        <div class="container">
                                            <p class="font-italic my-0 small">
                                                Du {{ house.dateBegin | date('d-m-Y') }} au {{ house.dateEnd | date('d-m-Y') }}
                                            </p>
                                        </div>
                                    </div>

                                    <div class="d-flex align-items-center mt-4">
                                        <i class="bi bi-images"></i>
                                        <p>&nbsp;</p>
                                        <p class="font-weight-bold my-0">Photos du logement : </p>
                                    </div>
                                    <div id="carouselExampleControls" class="carousel carousel-dark slide"
                                         data-bs-ride="carousel" data-bs-interval="2500">
                                        <div class="carousel-inner">
                                            <div class="carousel-item active">
                                                <img src="{{ asset('uploads/images/' ~ house.imageFilename) }}" class="d-block w-100"
                                                     alt="{{ house.imageFilename }}">
                                            </div>
                                        </div>
                                        <button class="carousel-control-prev" type="button"
                                                data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                            <span class="visually-hidden">Previous</span>
                                        </button>
                                        <button class="carousel-control-next" type="button"
                                                data-bs-target="#carouselExampleControls" data-bs-slide="next">
                                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                            <span class="visually-hidden">Next</span>
                                        </button>
                                    </div>

                                    <!--                                <div>-->
                                    <!--                                    <div id="small-img" class="col-xs-12 col-sm-12 col-md-12 col-lg-12 center">-->
                                    <!--                                        <table>-->
                                    <!--                                            <tr>-->
                                    <!--                                                <td th:each="image : ${house.images}">-->
                                    <!--                                                    <img th:src="${image.getPhotosImagePath()}" class="p-1"/>-->
                                    <!--                                                </td>-->
                                    <!--                                            </tr>-->
                                    <!--                                        </table>-->
                                    <!--                                    </div>-->
                                    <!--                                </div>-->
                                    <div class="my-3 text-center">
                                        <a class="btn btn-primary" href="{{ path('app_house_detailed_view', {'id': house.id}) }}" role="button">Détails
                                            de l'annonce</a>
                                        <a class="btn btn-primary" href="{{ path('app_booking_new', {'id': house.id}) }}" role="button">Réserver</a>
                                        <a class="btn btn-primary" href="{{ path('app_messages', {'id': house.keyUser.id}) }}" role="button">Envoyer
                                            un message à l'annonceur</a>
                                    </div>
                                </div>
                                <!-- End -->
                            </li>
                            <!-- End -->
                        </ul>
                        <!-- End -->
                    </div>
                </div>
            </div>


{#            <div class="container m-auto w-75 p-3">#}
{#                <a style="font-weight: bold"#}
{#                   href="{{ path('app_house_detailed_view', {'id': house.id}) }}">{{ house.title }}</a>#}
{#                <div>{{ house.description }}</div>#}
{#                <div>{{ house.dateBegin | date('d-m-Y') }}</div>#}
{#                <div>{{ house.dateEnd | date('d-m-Y') }}</div>#}
{#                <div>{{ house.keyTypeAccommodationCapacity.capacity }}</div>#}
{#                <div>{{ house.keyListeVilleFrance.name ~ ' (' ~ house.keyListeVilleFrance.department ~ ')' }} </div>#}
{#                <img src="{{ asset('uploads/images/' ~ house.imageFilename) }}">#}
{#                {% if app.user.id != house.keyUser.id %}#}
{#                    <a class="btn btn-primary" href="{{ path('app_booking_new', {'id': house.id}) }}">Réserver</a>#}
{#                    <a class="btn btn-primary" href="{{ path('app_messages', {'id': house.keyUser.id}) }}">#}
{#                        Envoyer un message au propriétaire</a>#}
{#                {% endif %}#}
{#            </div>#}
        {% endfor %}

    </div>

{% endblock %}